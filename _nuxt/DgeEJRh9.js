import{y as n,z as l,A as e,d as at,a as nt,S as lt,$ as rt,r as m,J as it,G as ut,H as ct,k as d,K as X,o as dt,C as _,N as p,W as L,X as R,B as i,E as vt,L as A,_ as pt}from"./B62gKW3z.js";import{C as ft,H as ht,f as H,r as mt,F as _t}from"./TGGHLkh7.js";function gt(x,g){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061A1.125 1.125 0 0 1 21 8.689v8.122ZM11.25 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061a1.125 1.125 0 0 1 1.683.977v8.122Z"})])}function bt(x,g){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}function kt(x,g){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"})])}function yt(x,g){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"})])}const wt={class:"product-page"},xt={class:"product-shell"},Ct={class:"product-grid"},It={class:"thumbs"},Pt=["onClick"],St=["src"],Tt={class:"main-image"},$t=["src"],Bt={class:"details"},Nt={class:"product-title"},Lt={class:"price-block"},Rt={class:"price-main"},At={class:"price-pix"},Ht={class:"price-installments"},qt={class:"variant-block"},zt={class:"variant-label"},Et={class:"option-list"},Mt=["onClick"],jt={class:"variant-block"},Ot={class:"option-list"},Qt=["onClick"],Vt={key:0,class:"variant-label !mb-1"},Gt={key:1,class:"variant-label !mb-1"},Dt={class:"buy-row"},Ft={class:"qty-control"},Xt={class:"qty-value"},Zt=["disabled"],Jt={key:0,class:"text-dm"},Kt={key:1},Ut={class:"buy-meta"},Wt={class:"flex flex-row gap-1"},Yt={class:"flex flex-row gap-1"},te=at({__name:"[id]",setup(x){const{$httpClient:g}=nt(),{loadingPush:q,loadingPop:z}=lt(),Z=rt(),C=m(!1),y=it(),E=ut(),P=ct(),S=ft(),v=m(null),a=m(null),r=m(null),h=m(""),b=m(1),M=m(null),J=d(()=>v.value?.product?.name??v.value?.name??"Produto"),f=d(()=>v.value?.images??v.value?.productImages??[]),u=d(()=>v.value?.skus??[]),T=d(()=>{const t=f.value.find(o=>o?.isPrimary);return k(t||f.value[0]||"")}),j=d(()=>{if(!u.value.length)return[];const t=r.value?u.value.filter(o=>o.size===r.value):u.value;return[...new Set(t.map(o=>o.color))].filter(Boolean)}),O=d(()=>{if(!u.value.length)return[];const t=a.value?u.value.filter(o=>o.color===a.value):u.value;return[...new Set(t.map(o=>o.size))].filter(Boolean)}),w=d(()=>u.value.length?a.value&&r.value?u.value.find(t=>t.color===a.value&&t.size===r.value):u.value.find(t=>t.isActive)??u.value[0]:null),$=d(()=>w.value?.price??0),K=d(()=>$.value*.8),U=d(()=>S[0].Quantity?$.value/S[0].Quantity:0);X(f,t=>{t.length&&(h.value=T.value)}),X([j,O],([t,o])=>{a.value&&!t.includes(a.value)&&(a.value=null),r.value&&!o.includes(r.value)&&(r.value=null)});function k(t){return t?typeof t=="string"?t:t.imageURL??t.url??"":""}function Q(t){const o=f.value.findIndex(B=>k(B)===h.value);if(o===-1)return;let s=o+t;s<0&&(s=f.value.length-1),s>=f.value.length&&(s=0),h.value=k(f.value[s]);const c=M.value;if(c){const N=c.getElementsByClassName("thumb-item")[s];if(N){const I=N.offsetTop,G=N.offsetHeight,D=c.scrollTop,F=c.clientHeight;I<D?c.scrollTop=I:I+G>D+F&&(c.scrollTop=I+G-F)}}}function W(){const t=w.value?.stock??10;b.value<t&&(b.value+=1)}function Y(){b.value>1&&(b.value-=1)}function tt(t){a.value===t?a.value=null:a.value=t,V()}function et(t){r.value===t?r.value=null:r.value=t,V()}function V(){!a.value||!r.value||(q(),setTimeout(()=>{z()},500))}async function ot(){q();try{const t=await g.product.GetProductsById(Number(Z.params.id));v.value=t?.result??null,h.value=T.value}catch(t){console.warn("Erro ao carregar produto:",t),v.value=null}finally{z()}}async function st(){if(!a.value||!r.value){y.info("Selecione cor e tamanho antes de comprar.");return}if(!P.isLogged){y.info("Por favor, faca login para continuar com a compra."),E.isLoginOpen=!0;return}try{C.value=!0;const t=await g.product.VerifyStock(v.value?.product?.id??v.value?.id,a.value,r.value);if(t.result!=null){const o={userId:P.userId??0,sessionId:"",products:[{productId:t.result.productId,color:t.result.color,size:t.result.size,quantity:b.value}]};await P.addItem(o),y.success("Produto adicionado ao carrinho com sucesso!")}}catch(t){if(t.code==="NOT_LOGGED"){y.info("Por favor, faca login para continuar."),E.isLoginOpen=!0;return}y.error(t.message??"Erro ao adicionar produto ao carrinho.")}finally{C.value=!1}}return dt(ot),(t,o)=>(l(),n("div",wt,[_(ht),e("div",xt,[e("div",Ct,[e("div",It,[e("button",{class:"thumb-nav",type:"button",onClick:o[0]||(o[0]=s=>Q(-1))},[_(p(kt),{class:"w-5 h-5"})]),e("div",{ref_key:"thumbListRef",ref:M,class:"thumb-list"},[(l(!0),n(L,null,R(f.value,(s,c)=>(l(),n("button",{key:c,type:"button",class:A(["thumb-item",{active:k(s)===h.value}]),onClick:B=>h.value=k(s)},[e("img",{src:k(s),alt:"Miniatura do produto"},null,8,St)],10,Pt))),128))],512),e("button",{class:"thumb-nav",type:"button",onClick:o[1]||(o[1]=s=>Q(1))},[_(p(bt),{class:"w-5 h-5"})])]),e("div",Tt,[e("img",{src:h.value||T.value,alt:"Imagem do produto"},null,8,$t)]),e("div",Bt,[e("h1",Nt,i(J.value),1),e("div",Lt,[e("div",Rt,"R$ "+i(p(H)($.value)),1),e("div",At,"R$ "+i(p(H)(K.value))+" com pagamento no PIX",1),e("div",Ht,i(p(S)[0].Quantity)+"x de R$ "+i(p(H)(U.value))+" sem juros ",1)]),e("div",qt,[e("span",zt,[o[2]||(o[2]=vt("Cor: ",-1)),e("strong",null,i(a.value||"-"),1)]),e("div",Et,[(l(!0),n(L,null,R(j.value,s=>(l(),n("button",{key:s,type:"button",class:A(["option-button",{active:a.value===s}]),onClick:c=>tt(s)},i(s),11,Mt))),128))])]),e("div",jt,[o[3]||(o[3]=e("span",{class:"variant-label"},"Tamanho:",-1)),e("div",Ot,[(l(!0),n(L,null,R(O.value,s=>(l(),n("button",{key:s,type:"button",class:A(["option-button",{active:r.value===s}]),onClick:c=>et(s)},i(s),11,Qt))),128))])]),w.value?.stock>1?(l(),n("span",Vt,i(w.value?.stock)+" quantidades disponiveis",1)):(l(),n("span",Gt,i(w.value?.stock)+" quantidade disponivel",1)),e("div",Dt,[e("div",Ft,[e("button",{type:"button",class:"qty-btn",onClick:Y},"-"),e("span",Xt,i(b.value),1),e("button",{type:"button",class:"qty-btn",onClick:W},"+")]),e("button",{class:"buy-button",type:"button",onClick:st,disabled:C.value},[_(p(mt),{class:"w-5 h-5"}),C.value?(l(),n("span",Jt,"Adicionando...")):(l(),n("span",Kt,"COMPRAR"))],8,Zt)]),e("div",Ut,[e("div",Wt,[_(p(gt),{class:"w-5 h-5"}),o[4]||(o[4]=e("span",null,"Entrega rapida",-1))]),e("div",Yt,[_(p(yt),{class:"w-5 h-5"}),o[5]||(o[5]=e("span",null,"Troca gratis",-1))])])])])]),_(_t)]))}}),se=pt(te,[["__scopeId","data-v-491f6d39"]]);export{se as default};
